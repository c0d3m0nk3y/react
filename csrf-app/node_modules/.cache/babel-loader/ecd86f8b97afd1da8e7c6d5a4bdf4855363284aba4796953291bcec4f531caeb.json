{"ast":null,"code":"import React, { Component } from 'react';\nconst API_HOST = 'http://localhost:8000';\nlet _csrfToken = null;\nasync function getCsrfToken() {\n  if (_csrfToken === null) {\n    const response = await fetch(`${API_HOST}/csrf/`, {\n      credentials: 'include'\n    });\n    const data = await response.json();\n    _csrfToken = data.csrfToken;\n  }\n  return _csrfToken;\n}\nasync function testRequest(method) {\n  const response = await fetch(`${API_HOST}/ping/`, {\n    method: method,\n    headers: method === 'POST' ? {\n      'X-CSRFToken': await getCsrfToken()\n    } : {},\n    credentials: 'include'\n  });\n  const data = await response.json();\n  return data.result;\n}\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      testGet: 'KO',\n      testPost: 'KO'\n    };\n  }\n  async componentDidMount() {\n    this.setState({\n      testGet: await testRequest('GET'),\n      testPost: await testRequest('POST')\n    });\n  }\n}","map":{"version":3,"names":["React","Component","API_HOST","_csrfToken","getCsrfToken","response","fetch","credentials","data","json","csrfToken","testRequest","method","headers","result","App","constructor","props","state","testGet","testPost","componentDidMount","setState"],"sources":["C:/Users/ricky/react/csrf-app/src/index.js"],"sourcesContent":["import React, { Component } from 'react';\r\n\r\nconst API_HOST = 'http://localhost:8000';\r\n\r\nlet _csrfToken = null;\r\n\r\nasync function getCsrfToken() {\r\n    if (_csrfToken === null) {\r\n        const response = await fetch(`${API_HOST}/csrf/`, {\r\n            credentials: 'include',\r\n        });\r\n        const data = await response.json();\r\n        _csrfToken = data.csrfToken;\r\n    }\r\n    return _csrfToken;\r\n}\r\n\r\nasync function testRequest(method) {\r\n    const response = await fetch(`${API_HOST}/ping/`, {\r\n        method: method,\r\n        headers: (\r\n            method === 'POST'\r\n                ? { 'X-CSRFToken': await getCsrfToken() }\r\n                : {}\r\n        ),\r\n        credentials: 'include',\r\n    });\r\n    const data = await response.json();\r\n    return data.result;\r\n}\r\n\r\nclass App extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            testGet: 'KO',\r\n            testPost: 'KO',\r\n        };\r\n    }\r\n\r\n    async componentDidMount() {\r\n        this.setState({\r\n            testGet: await testRequest('GET'),\r\n            testPost: await testRequest('POST'),\r\n        });\r\n    }\r\n}\r\n"],"mappings":"AAAA,OAAOA,KAAK,IAAIC,SAAS,QAAQ,OAAO;AAExC,MAAMC,QAAQ,GAAG,uBAAuB;AAExC,IAAIC,UAAU,GAAG,IAAI;AAErB,eAAeC,YAAY,GAAG;EAC1B,IAAID,UAAU,KAAK,IAAI,EAAE;IACrB,MAAME,QAAQ,GAAG,MAAMC,KAAK,CAAE,GAAEJ,QAAS,QAAO,EAAE;MAC9CK,WAAW,EAAE;IACjB,CAAC,CAAC;IACF,MAAMC,IAAI,GAAG,MAAMH,QAAQ,CAACI,IAAI,EAAE;IAClCN,UAAU,GAAGK,IAAI,CAACE,SAAS;EAC/B;EACA,OAAOP,UAAU;AACrB;AAEA,eAAeQ,WAAW,CAACC,MAAM,EAAE;EAC/B,MAAMP,QAAQ,GAAG,MAAMC,KAAK,CAAE,GAAEJ,QAAS,QAAO,EAAE;IAC9CU,MAAM,EAAEA,MAAM;IACdC,OAAO,EACHD,MAAM,KAAK,MAAM,GACX;MAAE,aAAa,EAAE,MAAMR,YAAY;IAAG,CAAC,GACvC,CAAC,CACV;IACDG,WAAW,EAAE;EACjB,CAAC,CAAC;EACF,MAAMC,IAAI,GAAG,MAAMH,QAAQ,CAACI,IAAI,EAAE;EAClC,OAAOD,IAAI,CAACM,MAAM;AACtB;AAEA,MAAMC,GAAG,SAASd,SAAS,CAAC;EACxBe,WAAW,CAACC,KAAK,EAAE;IACf,KAAK,CAACA,KAAK,CAAC;IACZ,IAAI,CAACC,KAAK,GAAG;MACTC,OAAO,EAAE,IAAI;MACbC,QAAQ,EAAE;IACd,CAAC;EACL;EAEA,MAAMC,iBAAiB,GAAG;IACtB,IAAI,CAACC,QAAQ,CAAC;MACVH,OAAO,EAAE,MAAMR,WAAW,CAAC,KAAK,CAAC;MACjCS,QAAQ,EAAE,MAAMT,WAAW,CAAC,MAAM;IACtC,CAAC,CAAC;EACN;AACJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}